{%  extends 'ctfpad/main.html' %}

{% block content %}

<br/>

{% include 'snippets/messages.html' %}

{{ form.errors }}

<div style="padding-left: 33%;">
    <div class="card" style="width: 35rem;">
        <div class="card-header">
            <h5 class="card-title">
                {% if form.name.value %}
                <p class="card-header-title">Updating CTF {{form.name.value}}</p>
                {% else %}
                <p class="card-header-title">New CTF</p>
                {% endif %}
            </h5>
        </div>

        <div class="card-body">
            <form class="form" method="post">
                {% csrf_token %}
                <div class="modal-body">
                    <div class="form-group">

                    <label class="label"><strong>Name</strong></label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-hat-cowboy-side"></i>
                            </span>
                        </div>
                        <input id="{{form.name.id_for_label}}" name="{{form.name.html_name }}" value="{{form.name.value}}" class="form-control" type="text" placeholder="{{form.name.label}}" required>
                    </div>

                    <label class="label"><strong>URL</strong></label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-link"></i>
                            </span>
                        </div>
                        <input id="{{form.url.id_for_label}}" name="{{form.url.html_name}}" placeholder="{{form.url.label}}" value="{{form.url.value}}" class="form-control" type="text">
                    </div>

                    <label class="label"><strong>Description</strong></label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-pen"></i>
                            </span>
                        </div>
                        <textarea id="{{form.description.id_for_label}}" name="{{form.description.html_name }}" placeholder="{{form.description.label}}" value="{{form.description.value}}" class="form-control">{% if form.description.value %}{{form.description.value}}{% endif %}</textarea>
                    </div>

                    <label class="label"><strong>Flag Prefix </strong>(if any)</label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-flag"></i>
                            </span>
                        </div>
                        <input id="{{form.flag_prefix.id_for_label}}" name="{{form.flag_prefix.html_name }}" placeholder="{{form.flag_prefix.label}}" value="{{form.flag_prefix.value}}" class="form-control" type="text">
                    </div>

                    <label class="label"><strong>Start Date</strong>(leave empty for permanent CTFs)</label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-calendar-day"></i>
                            </span>
                        </div>

                        <input id={{form.start_date.id_for_label}} name="{{form.start_date.html_name }}" placeholder="{{form.start_date.label}}"
                        {% if form.start_date.value %}
                        value="{{form.start_date.value | date:'Y-m-d H:i:s'}}"
                        {% endif %}
                        class="form-control" type="text">
                        <small class="form-text text-muted"><a href="https://docs.djangoproject.com/en/3.1/ref/settings/#std:setting-DATETIME_INPUT_FORMATS">Accepted date formats</a></small>
                    </div>

                    <label class="label"><strong>End Date</strong>(leave empty for permanent CTFs)</label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-calendar-day"></i>
                            </span>
                        </div>
                        <input id={{form.end_date.id_for_label}} name="{{form.end_date.html_name }}" placeholder="{{form.end_date.label}}"
                        {% if form.end_date.value %}
                        value="{{form.end_date.value | date:'Y-m-d H:i:s'}}"
                        {% endif %}
                        class="form-control" type="text">
                        <small class="form-text text-muted"><a href="https://docs.djangoproject.com/en/3.1/ref/settings/#std:setting-DATETIME_INPUT_FORMATS">Accepted date formats</a></small>
                    </div>

                    <label class="label"><strong>Team Login</strong></label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-sign-in-alt"></i>
                            </span>
                        </div>
                        <input id="{{form.team_login.id_for_label}}" name="{{form.team_login.html_name }}" placeholder="{{form.team_login.label}}" value="{{form.team_login.value}}" class="form-control" type="text">
                    </div>

                    <label class="label"><strong>Team Password</strong></label>
                    <div class="input-group mb-3">
                        <div class="input-group-append">
                            <span class="input-group-text">
                                <i class="fas fa-key"></i>
                            </span>
                        </div>
                        <input id="{{form.team_password.id_for_label}}" name="{{form.team_password.html_name }}" placeholder="{{form.team_password.label}}"  class="form-control" type="text" value="{{form.team_login.value}}" >

                        <button class="form-control btn btn-info" onclick="document.getElementById('{{form.team_password.id_for_label}}').value=generate_random_string(16); return false;">
                            Generate
                        </button>
                    </div>

                </div>

                <div class="card-footer text-muted">
                    <div class="control card-footer-item">
                        {% if form.name.value %}
                        <button type="button" class="btn-primary btn-sm btn-block" onclick="this.form.submit();">Update CTF</button>
                        {% else %}
                        <button type="button" class="btn-primary btn-sm btn-block" onclick="this.form.submit();">Create CTF</button>
                        {% endif %}
                        <button type="button" class="btn btn-secondary btn-sm btn-block" onclick="window.history.back();">Cancel</button>
                    </div>
                </div>

            </form>

        </div>
    </div>
</div>

{% endblock %}